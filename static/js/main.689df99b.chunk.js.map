{"version":3,"sources":["../node_modules/peerjs/dist sync","App.module.css","App.tsx","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","styles","require","App","props","_localVideo","_remoteVideo","_remoteId","_localStream","_remoteStream","_peer","call","event","preventDefault","remoteId","current","value","captureCallStream","copyLocalIdToClipboard","input","document","createElement","root","getElementById","appendChild","select","execCommand","removeChild","state","localId","isRemoteVisible","React","Peer","key","localVideo","this","navigator","mediaDevices","getUserMedia","video","audio","srcObject","on","setState","window","confirm","peer","answer","error","console","remoteStream","remoteContent","className","remoteVideo","autoPlay","ref","form","onSubmit","formGroup","formLabel","formItem","formId","type","formButton","title","icon","onClick","app","remoteVideoContainer","localVideoContainer","ReactDOM"],"mappings":"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","file":"static/js/main.689df99b.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 17;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__1kX79\",\"remoteVideoContainer\":\"App_remoteVideoContainer__3Ivad\",\"localVideoContainer\":\"App_localVideoContainer__Ed5r_\",\"video\":\"App_video__33LfF\",\"remoteVideo\":\"App_remoteVideo__75MRL App_video__33LfF\",\"form\":\"App_form__30Y9M\",\"formGroup\":\"App_formGroup__3WCP6\",\"formLabel\":\"App_formLabel__1M7Lt\",\"formItem\":\"App_formItem__CNroQ\",\"formId\":\"App_formId__1e-xR\",\"formButton\":\"App_formButton__1Gtm6\",\"icon\":\"App_icon__NYH35\",\"localVideo\":\"App_localVideo__2nimy App_video__33LfF\"};","import * as React from 'react';\nimport Peer from 'peerjs';\nconst styles = require('./App.module.css');\n\ninterface AppProps {}\n\ninterface AppState {\n  localId: string;\n  isRemoteVisible: boolean;\n}\n\nclass App extends React.Component<AppProps, AppState> {\n  private _localVideo: React.RefObject<HTMLVideoElement>;\n  private _remoteVideo: React.RefObject<HTMLVideoElement>;\n  private _remoteId: React.RefObject<HTMLInputElement>;\n  private _localStream?: MediaStream;\n  private _remoteStream?: MediaStream;\n  private _peer: Peer;\n\n  constructor(props: AppProps) {\n    super(props);\n\n    // intial state\n    this.state = {\n      localId: '',\n      isRemoteVisible: false\n    };\n\n    this._localVideo = React.createRef();\n    this._remoteVideo = React.createRef();\n    this._remoteId = React.createRef();\n    this._peer = new Peer({key: 'peerjs'});\n  }\n\n  async componentDidMount() {\n    const localVideo = this._localVideo.current as HTMLVideoElement;\n    this._localStream = await navigator.mediaDevices.getUserMedia({video: true, audio: true});\n    localVideo.srcObject = this._localStream;\n\n    this._peer.on('open', () => {\n      this.setState({\n        localId: this._peer.id\n      });\n    });\n\n    // when remote calls\n    this._peer.on('call', (call: Peer.MediaConnection) => {\n      if (!window.confirm(`${call.peer} is calling. Answer call?`)) {\n        return;\n      }\n      this.answer(call);\n    });\n\n    this._peer.on('error', (error) => {\n      console.error(error);\n    });\n  }\n\n  componentDidUpdate(): void {\n    if (this._remoteStream) {\n      const remoteVideo = this._remoteVideo.current as HTMLVideoElement;\n      remoteVideo.srcObject = this._remoteStream;\n    }\n  }\n\n  // used in template\n  call = (event: React.FormEvent): void => {\n    event.preventDefault();\n    const remoteId = this._remoteId.current as HTMLInputElement;\n    const call = this._peer.call(remoteId.value, this._localStream!);\n    this.captureCallStream(call);\n  }\n\n  answer(call: Peer.MediaConnection): void {\n    // answer call with local video stream\n    call.answer(this._localStream);\n    this.captureCallStream(call);\n  }\n\n  captureCallStream(call: Peer.MediaConnection): void {\n    call.on('stream', (remoteStream) => {\n      this._remoteStream = remoteStream;\n      this.setState({isRemoteVisible: true});\n    });\n  }\n\n  copyLocalIdToClipboard = (): void => {\n    const input = document.createElement('input');\n    const root = document.getElementById('root') as HTMLElement;\n    root.appendChild(input);\n    input.value = this._peer.id;\n    input.select();\n    document.execCommand('copy');\n    root.removeChild(input);\n  }\n\n  render() {\n    const remoteContent = this.state.isRemoteVisible ? (\n      <video\n        className={styles.remoteVideo}\n        autoPlay={true}\n        ref={this._remoteVideo}\n      />\n    ) : (\n      <form\n        className={styles.form}\n        onSubmit={this.call}\n      >\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Call someone's ID:</label>\n          <div className={styles.formItem}>\n            <input className={styles.formId} type=\"text\" ref={this._remoteId}/>\n            <button className={styles.formButton} type=\"submit\" title=\"Start call\">\n              <i className={`material-icons ${styles.icon}`}>videocam</i>\n            </button>\n          </div>\n        </div>\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Copy your ID:</label>\n          <div className={styles.formItem}>\n            <span className={styles.formId}>{this.state.localId}</span>\n            <button className={styles.formButton} type=\"button\" title=\"Copy to clipboard\" onClick={this.copyLocalIdToClipboard}>\n              <i className={`material-icons ${styles.icon}`}>file_copy</i>\n            </button>\n          </div>\n        </div>\n      </form>\n    );\n\n    return (\n      <div className={styles.app}>\n        <div className={styles.remoteVideoContainer}>\n          {remoteContent}\n        </div>\n        <div className={styles.localVideoContainer}>\n          <video\n            className={styles.localVideo}\n            autoPlay={true}\n            ref={this._localVideo}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport { App };\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { App } from './App';\n\nimport './reset.css';\nimport './index.module.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}